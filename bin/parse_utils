#!/bin/bash
PWD=$(pwd)
DIR=${REBAR_ROOT_DIR:-$PWD}

erl -noshell -eval "\
  {ok, Forms} = epp:parse_file('${DIR}/src/code_gen_utils.erl', []),\
  Contents = io_lib:format(\
    \"-module(code_gen_utils_parsed).~n\"\
    \"-export([forms/0]).~n\"\
    \"forms() -> ~p.~n\",\
    [Forms]\
  ),\
  file:write_file('${DIR}/src/code_gen_utils_parsed.erl', Contents),\
  halt()\
"
